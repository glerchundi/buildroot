diff -rupN buildroot/package/nginx/0001-auto-type-sizeof-rework-autotest-to-be-cross-compila.patch ../../misc/buildroot/package/nginx/0001-auto-type-sizeof-rework-autotest-to-be-cross-compila.patch
--- buildroot/package/nginx/0001-auto-type-sizeof-rework-autotest-to-be-cross-compila.patch	2015-08-12 08:49:44.000000000 +0200
+++ ../../misc/buildroot/package/nginx/0001-auto-type-sizeof-rework-autotest-to-be-cross-compila.patch	2015-08-11 14:43:56.000000000 +0200
@@ -1,4 +1,4 @@
-From 81289d1d1adaf5a767a4b4d1309c286468cfd37f Mon Sep 17 00:00:00 2001
+From fe05ccf80afe5de33d4f9c5e5545390c450bcd2d Mon Sep 17 00:00:00 2001
 From: Samuel Martin <s.martin49@gmail.com>
 Date: Thu, 24 Apr 2014 23:27:32 +0200
 Subject: [PATCH 1/5] auto/type/sizeof: rework autotest to be cross-compilation
@@ -9,12 +9,16 @@ runtime. This way, it does not break whe
 different CPU architecture.
 
 Signed-off-by: Samuel Martin <s.martin49@gmail.com>
+
+Refresh for 1.8.0.
+
+Signed-off-by: Danomi Manchego <danomimanchego123@gmail.com>
 ---
  auto/types/sizeof | 42 ++++++++++++++++++++++++++++--------------
  1 file changed, 28 insertions(+), 14 deletions(-)
 
 diff --git a/auto/types/sizeof b/auto/types/sizeof
-index 9215a54..c2c3ede 100644
+index a5f66bb..c6f31ec 100644
 --- a/auto/types/sizeof
 +++ b/auto/types/sizeof
 @@ -14,7 +14,7 @@ END
@@ -82,7 +86,7 @@ index 9215a54..c2c3ede 100644
 -
  case $ngx_size in
      4)
-         if [ "$ngx_type"="long" ]; then
+         ngx_max_value=2147483647
 -- 
-1.9.2
+1.9.1
 
diff -rupN buildroot/package/nginx/0003-auto-set-ngx_feature_run_force_result-for-each-featu.patch ../../misc/buildroot/package/nginx/0003-auto-set-ngx_feature_run_force_result-for-each-featu.patch
--- buildroot/package/nginx/0003-auto-set-ngx_feature_run_force_result-for-each-featu.patch	2015-08-12 08:49:44.000000000 +0200
+++ ../../misc/buildroot/package/nginx/0003-auto-set-ngx_feature_run_force_result-for-each-featu.patch	2015-08-11 14:43:56.000000000 +0200
@@ -1,4 +1,4 @@
-From 7d1bc0364feab22299abeeb29ae2cfdcabd7e2c0 Mon Sep 17 00:00:00 2001
+From 71939b727a8fa9f722934700948a5b68960f6183 Mon Sep 17 00:00:00 2001
 From: Samuel Martin <s.martin49@gmail.com>
 Date: Thu, 29 May 2014 18:52:10 +0200
 Subject: [PATCH 3/5] auto/*: set ngx_feature_run_force_result for each feature
@@ -11,6 +11,10 @@ These ngx_force_* variables are passed t
 time.
 
 Signed-off-by: Samuel Martin <s.martin49@gmail.com>
+
+Refresh for 1.8.0.
+
+Signed-off-by: Danomi Manchego <danomimanchego123@gmail.com>
 ---
  auto/cc/conf            | 3 +++
  auto/cc/name            | 1 +
@@ -73,7 +77,7 @@ index d1e484a..3724916 100644
                        #include <atomic_ops.h>"
      ngx_feature_path=
 diff --git a/auto/os/darwin b/auto/os/darwin
-index b97518a..30f323c 100644
+index 1d3e3d3..11b7276 100644
 --- a/auto/os/darwin
 +++ b/auto/os/darwin
 @@ -27,6 +27,7 @@ NGX_KQUEUE_CHECKED=YES
@@ -137,7 +141,7 @@ index 19bf832..16848b2 100644
  ngx_feature_path=
  ngx_feature_libs=
 diff --git a/auto/unix b/auto/unix
-index 10fd3d2..b7cc9cb 100755
+index 6e54531..7dbf9d1 100755
 --- a/auto/unix
 +++ b/auto/unix
 @@ -99,6 +99,7 @@ if test -z "$NGX_KQUEUE_CHECKED"; then
@@ -148,7 +152,7 @@ index 10fd3d2..b7cc9cb 100755
          ngx_feature_incs="#include <sys/event.h>
                            #include <sys/time.h>"
          ngx_feature_path=
-@@ -544,6 +545,7 @@ ngx_feature_test="char buf[1]; ssize_t n; n = pwrite(1, buf, 1, 0);
+@@ -589,6 +590,7 @@ ngx_feature_test="char buf[1]; ssize_t n; n = pwrite(1, buf, 1, 0);
  ngx_feature="sys_nerr"
  ngx_feature_name="NGX_SYS_NERR"
  ngx_feature_run=value
@@ -156,7 +160,7 @@ index 10fd3d2..b7cc9cb 100755
  ngx_feature_incs='#include <errno.h>
                    #include <stdio.h>'
  ngx_feature_path=
-@@ -558,6 +560,7 @@ if [ $ngx_found = no ]; then
+@@ -603,6 +605,7 @@ if [ $ngx_found = no ]; then
      ngx_feature="_sys_nerr"
      ngx_feature_name="NGX_SYS_NERR"
      ngx_feature_run=value
@@ -164,7 +168,7 @@ index 10fd3d2..b7cc9cb 100755
      ngx_feature_incs='#include <errno.h>
                        #include <stdio.h>'
      ngx_feature_path=
-@@ -573,6 +576,7 @@ if [ $ngx_found = no ]; then
+@@ -618,6 +621,7 @@ if [ $ngx_found = no ]; then
      ngx_feature='maximum errno'
      ngx_feature_name=NGX_SYS_NERR
      ngx_feature_run=value
@@ -172,7 +176,7 @@ index 10fd3d2..b7cc9cb 100755
      ngx_feature_incs='#include <errno.h>
                        #include <string.h>
                        #include <stdio.h>'
-@@ -631,6 +635,7 @@ ngx_feature_test="void *p; p = memalign(4096, 4096);
+@@ -676,6 +680,7 @@ ngx_feature_test="void *p; p = memalign(4096, 4096);
  ngx_feature="mmap(MAP_ANON|MAP_SHARED)"
  ngx_feature_name="NGX_HAVE_MAP_ANON"
  ngx_feature_run=yes
@@ -180,7 +184,7 @@ index 10fd3d2..b7cc9cb 100755
  ngx_feature_incs="#include <sys/mman.h>"
  ngx_feature_path=
  ngx_feature_libs=
-@@ -644,6 +649,7 @@ ngx_feature_test="void *p;
+@@ -689,6 +694,7 @@ ngx_feature_test="void *p;
  ngx_feature='mmap("/dev/zero", MAP_SHARED)'
  ngx_feature_name="NGX_HAVE_MAP_DEVZERO"
  ngx_feature_run=yes
@@ -188,7 +192,7 @@ index 10fd3d2..b7cc9cb 100755
  ngx_feature_incs="#include <sys/mman.h>
                    #include <sys/stat.h>
                    #include <fcntl.h>"
-@@ -659,6 +665,7 @@ ngx_feature_test='void *p; int  fd;
+@@ -704,6 +710,7 @@ ngx_feature_test='void *p; int  fd;
  ngx_feature="System V shared memory"
  ngx_feature_name="NGX_HAVE_SYSVSHM"
  ngx_feature_run=yes
@@ -196,7 +200,7 @@ index 10fd3d2..b7cc9cb 100755
  ngx_feature_incs="#include <sys/ipc.h>
                    #include <sys/shm.h>"
  ngx_feature_path=
-@@ -673,6 +680,7 @@ ngx_feature_test="int  id;
+@@ -718,6 +725,7 @@ ngx_feature_test="int  id;
  ngx_feature="POSIX semaphores"
  ngx_feature_name="NGX_HAVE_POSIX_SEM"
  ngx_feature_run=yes
@@ -205,5 +209,5 @@ index 10fd3d2..b7cc9cb 100755
  ngx_feature_path=
  ngx_feature_libs=
 -- 
-1.9.2
+1.9.1
 
diff -rupN buildroot/package/nginx/0005-auto-unix-make-sys_nerr-guessing-cross-friendly.patch ../../misc/buildroot/package/nginx/0005-auto-unix-make-sys_nerr-guessing-cross-friendly.patch
--- buildroot/package/nginx/0005-auto-unix-make-sys_nerr-guessing-cross-friendly.patch	2015-08-12 08:49:44.000000000 +0200
+++ ../../misc/buildroot/package/nginx/0005-auto-unix-make-sys_nerr-guessing-cross-friendly.patch	2015-08-11 14:43:56.000000000 +0200
@@ -1,4 +1,4 @@
-From 8c19cea5e667f325ececdc1678bfddf063af0da2 Mon Sep 17 00:00:00 2001
+From 08617a8d29ee22831175697555558fec8f52772c Mon Sep 17 00:00:00 2001
 From: Samuel Martin <s.martin49@gmail.com>
 Date: Sun, 1 Jun 2014 16:05:04 +0200
 Subject: [PATCH 5/5] auto/unix: make sys_nerr guessing cross-friendly
@@ -11,15 +11,19 @@ macro if defined, or the EHWPOISON (whic
 otherwise.
 
 Signed-off-by: Samuel Martin <s.martin49@gmail.com>
+
+Refresh for 1.8.0.
+
+Signed-off-by: Danomi Manchego <danomimanchego123@gmail.com>
 ---
- auto/os/sys_nerr | 77 ++++++++++++++++++++++++++++++++++++++++++++++++++++++++
+ auto/os/sys_nerr | 78 ++++++++++++++++++++++++++++++++++++++++++++++++++++++++
  auto/unix        | 10 ++++++++
- 2 files changed, 87 insertions(+)
+ 2 files changed, 88 insertions(+)
  create mode 100644 auto/os/sys_nerr
 
 diff --git a/auto/os/sys_nerr b/auto/os/sys_nerr
 new file mode 100644
-index 0000000..25e7c22
+index 0000000..8970f5f
 --- /dev/null
 +++ b/auto/os/sys_nerr
 @@ -0,0 +1,78 @@
@@ -102,10 +106,10 @@ index 0000000..25e7c22
 +
 +echo " $ngx_sys_nerr"
 diff --git a/auto/unix b/auto/unix
-index b7cc9cb..1a49ba3 100755
+index 7dbf9d1..00a7370 100755
 --- a/auto/unix
 +++ b/auto/unix
-@@ -550,6 +550,10 @@ ngx_feature_incs='#include <errno.h>
+@@ -595,6 +595,10 @@ ngx_feature_incs='#include <errno.h>
                    #include <stdio.h>'
  ngx_feature_path=
  ngx_feature_libs=
@@ -116,7 +120,7 @@ index b7cc9cb..1a49ba3 100755
  ngx_feature_test='printf("%d", sys_nerr);'
  . auto/feature
  
-@@ -598,6 +602,12 @@ if [ $ngx_found = no ]; then
+@@ -643,6 +647,12 @@ if [ $ngx_found = no ]; then
      . auto/feature
  fi
  
@@ -130,5 +134,5 @@ index b7cc9cb..1a49ba3 100755
  ngx_feature="localtime_r()"
  ngx_feature_name="NGX_HAVE_LOCALTIME_R"
 -- 
-1.9.2
+1.9.1
 
diff -rupN buildroot/package/nginx/nginx.hash ../../misc/buildroot/package/nginx/nginx.hash
--- buildroot/package/nginx/nginx.hash	2015-08-12 08:49:44.000000000 +0200
+++ ../../misc/buildroot/package/nginx/nginx.hash	2015-08-11 14:43:56.000000000 +0200
@@ -1,2 +1,2 @@
 # Locally calculated after checking pgp signature
-sha256	0a98e95b366e4d6042f331e1fa4d70e18fd1e49d8993e589008e70e742b7e757	nginx-1.6.3.tar.gz
+sha256	23cca1239990c818d8f6da118320c4979aadf5386deda691b1b7c2c96b9df3d5	nginx-1.8.0.tar.gz
diff -rupN buildroot/package/nginx/nginx.mk ../../misc/buildroot/package/nginx/nginx.mk
--- buildroot/package/nginx/nginx.mk	2015-08-12 08:49:44.000000000 +0200
+++ ../../misc/buildroot/package/nginx/nginx.mk	2015-08-11 14:43:56.000000000 +0200
@@ -4,7 +4,7 @@
 #
 ################################################################################
 
-NGINX_VERSION = 1.6.3
+NGINX_VERSION = 1.8.0
 NGINX_SITE = http://nginx.org/download
 NGINX_LICENSE = BSD-2c
 NGINX_LICENSE_FILES = LICENSE
@@ -222,7 +222,7 @@ endef
 
 define NGINX_INSTALL_TARGET_CMDS
 	$(TARGET_MAKE_ENV) $(MAKE) -C $(@D) DESTDIR=$(TARGET_DIR) install
-	-$(RM) $(TARGET_DIR)/usr/bin/nginx.old
+	$(RM) $(TARGET_DIR)/usr/sbin/nginx.old
 	$(INSTALL) -D -m 0664 package/nginx/nginx.logrotate \
 		$(TARGET_DIR)/etc/logrotate.d/nginx
 endef
@@ -230,6 +230,11 @@ endef
 define NGINX_INSTALL_INIT_SYSTEMD
 	$(INSTALL) -D -m 0644 package/nginx/nginx.service \
 		$(TARGET_DIR)/usr/lib/systemd/system/nginx.service
+
+	mkdir -p $(TARGET_DIR)/etc/systemd/system/multi-user.target.wants
+
+	ln -fs ../../../../usr/lib/systemd/system/nginx.service \
+		$(TARGET_DIR)/etc/systemd/system/multi-user.target.wants/nginx.service
 endef
 
 define NGINX_INSTALL_INIT_SYSV
